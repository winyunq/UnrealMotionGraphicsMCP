[Click here for English version](Readme.md)

# UE5-UMG-MCP ğŸ¤–ğŸ“„

**ä¸€ä¸ªä»¥ç‰ˆæœ¬æ§åˆ¶ä¸ºæ ¸å¿ƒçš„AIååŒUMGå·¥ä½œæµ**



![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)![Status: Experimental](https://img.shields.io/badge/status-experimental-red.svg)![Built with AI](https://img.shields.io/badge/Built%20with-AI%20Assistance-blueviolet.svg)
[ä¸€ä¸ªç®€å•çš„RTSç•Œé¢](https://www.bilibili.com/video/BV1mCUpBwEnc)
---

### ğŸš€ å¿«é€Ÿå¼€å§‹

æœ¬æŒ‡å—åŒ…å«å®‰è£… `UmgMcp` æ’ä»¶å¹¶è¿æ¥åˆ° Gemini CLI çš„ä¸¤ä¸ªæ ¸å¿ƒæ­¥éª¤ã€‚

    ```bash
    git clone https://github.com/winyunq/UnrealMotionGraphicsMCP.git UmgMcp
    ```

3.  **é‡å¯Unrealç¼–è¾‘å™¨ã€‚** è¿™å°†å…è®¸å¼•æ“æ£€æµ‹å¹¶ç¼–è¯‘æ–°æ’ä»¶ã€‚

#### 2. è¿æ¥ Gemini CLI

å‘Šè¯‰ Gemini å¦‚ä½•æ‰¾åˆ°å¹¶å¯åŠ¨ MCP æœåŠ¡å™¨ã€‚

1.  **ç¼–è¾‘æ‚¨çš„ `settings.json` æ–‡ä»¶** (é€šå¸¸ä½äº `C:\Users\æ‚¨çš„ç”¨æˆ·å\.gemini\`)ã€‚
2.  **å°†å·¥å…·å®šä¹‰æ·»åŠ **åˆ° `tools` å¯¹è±¡ä¸­ã€‚

    ```json
    "mcpServers": {
      "UmgMcp": {
        "command": "uv",
        "args": [
          "run",
          "--directory",
          "D:\\æ‚¨çš„é¡¹ç›®è·¯å¾„\\Plugins\\UmgMcp\\Resources\\Python",
          "UmgMcpServer.py"
        ]
      },
      "UmgSequencer": {
        "command": "uv",
        "args": [
          "run",
          "--directory",
          "D:\\æ‚¨çš„é¡¹ç›®è·¯å¾„\\Plugins\\UmgMcp\\Resources\\Python",
          "UmgSequencerServer.py"
        ]
      }
    }
    ```
    **é‡è¦æç¤º:** æ‚¨ **å¿…é¡»** å°†è·¯å¾„æ›¿æ¢ä¸ºæ‚¨æœºå™¨ä¸Šå…‹éš†ä»“åº“å `Resources/Python` æ–‡ä»¶å¤¹çš„**ç»å¯¹è·¯å¾„**ã€‚

å®Œæˆï¼å½“æ‚¨å¯åŠ¨ Gemini CLI æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨åœ¨åå°å¯åŠ¨ MCP æœåŠ¡å™¨ã€‚

#### æµ‹è¯•è¿æ¥

é‡å¯ Gemini CLI å¹¶æ‰“å¼€æ‚¨çš„ Unreal é¡¹ç›®åï¼Œæ‚¨å¯ä»¥ç›´æ¥è°ƒç”¨ä»»ä½•å·¥å…·å‡½æ•°æ¥æµ‹è¯•è¿æ¥ï¼š
```python
  cd Resources/Python/APITest
  python UE5_Editor_Imitation.py
```

#### Python ç¯å¢ƒ (å¯é€‰)

æ’ä»¶çš„ Python ç¯å¢ƒç”± `uv` ç®¡ç†ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä¼šè‡ªåŠ¨è¿è¡Œã€‚å¦‚æœæ‚¨é‡åˆ°ä¸ Python ä¾èµ–ç›¸å…³çš„é—®é¢˜ï¼ˆä¾‹å¦‚ `uv` å‘½ä»¤æ‰¾ä¸åˆ°æˆ–æ¨¡å—å¯¼å…¥é”™è¯¯ï¼‰ï¼Œå¯ä»¥æ‰‹åŠ¨è®¾ç½®ç¯å¢ƒï¼š

1.  è¿›å…¥ç›®å½•: `cd æ‚¨çš„Unrealé¡¹ç›®/Plugins/UmgMcp/Resources/Python`
2.  è¿è¡Œè®¾ç½®:
    ```bash
    uv venv
    .\.venv\Scripts\activate
    uv pip install -e .
    ```

---

## æç¤ºè¯ç®¡ç†å™¨ (Prompt Manager)

è¿™æ˜¯ä¸€ä¸ªå¯è§†åŒ–çš„ Web å·¥å…·ï¼Œç”¨äºé…ç½® MCP æœåŠ¡å™¨çš„ç³»ç»Ÿæç¤ºè¯ã€å·¥å…·æè¿°ä»¥åŠç”¨æˆ·æ¨¡æ¿ã€‚

### åŠŸèƒ½äº®ç‚¹

1.  **ç³»ç»Ÿæç¤ºè¯ç¼–è¾‘**ï¼šç›´æ¥ä¿®æ”¹ AI çš„å…¨å±€æŒ‡ä»¤ã€‚
2.  **å·¥å…·ç®¡ç†**ï¼š
    *   **å¯ç”¨/ç¦ç”¨**ï¼šé€šè¿‡å¼€å…³ï¼ˆToggleï¼‰æ¥å¯ç”¨æˆ–ç¦ç”¨ç‰¹å®šçš„ MCP å·¥å…·ã€‚ç¦ç”¨å·¥å…·åï¼Œè¯¥å·¥å…·å°†ä¸ä¼šæ³¨å†Œåˆ° MCP æœåŠ¡å™¨ï¼Œä»è€Œ**å‹ç¼©ä¸Šä¸‹æ–‡çª—å£**ï¼Œé¿å… AI è¢«æ— å…³å·¥å…·å¹²æ‰°ã€‚
    *   **ç¼–è¾‘æè¿°**ï¼šä¿®æ”¹å·¥å…·çš„æç¤ºè¯ï¼ˆDescriptionï¼‰ï¼Œä½¿å…¶æ›´é€‚åˆæ‚¨çš„ç‰¹å®šå·¥ä½œæµã€‚
3.  **ç”¨æˆ·æ¨¡æ¿ (Prompts)**ï¼šæ·»åŠ é¢„ç½®çš„ Promptsï¼Œä¾› MCP å®¢æˆ·ç«¯ç›´æ¥è°ƒç”¨ã€‚

### è¿è¡Œæ–¹æ³•

åœ¨ Python ç¯å¢ƒä¸‹è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
```bash
python Resources/Python/PromptManager/server.py
```
æµè§ˆå™¨å°†è‡ªåŠ¨æ‰“å¼€ `http://localhost:8085`ã€‚

### ä½¿ç”¨å»ºè®®

æç¤ºè¯æ˜¯ AI å·¥å…·æ•ˆèƒ½çš„å…³é”®ã€‚é€šè¿‡ Prompt Managerï¼Œæ‚¨å¯ä»¥æ ¹æ®éœ€æ±‚å®šåˆ¶ AI çš„è¡Œä¸ºï¼š

*   **ä¸€é”®éƒ¨ç½²æ¨¡å¼**ï¼šå¦‚æœæ‚¨å¸Œæœ› AI ä¸“æ³¨äºæ ¹æ®è®¾è®¡ç”Ÿæˆ UIï¼Œå¯ä»¥å…³é—­é™¤äº† `apply_layout` å’Œ `export_umg_to_json` ä¹‹å¤–çš„æ‰€æœ‰å·¥å…·ã€‚
*   **æ•™å­¦æ¨¡å¼**ï¼šå¦‚æœæ‚¨å¸Œæœ› AI ä½œä¸ºå¯¼å¸ˆæŒ‡å¯¼æ‚¨å­¦ä¹  UMGï¼Œå¯ä»¥åªä¿ç•™åªè¯»å·¥å…·ï¼ˆå¦‚ `get_widget_tree`, `get_widget_schema`ï¼‰ï¼Œé˜²æ­¢ AI è‡ªåŠ¨ä¿®æ”¹æ‚¨çš„èµ„äº§ã€‚
*   **ä¸Šä¸‹æ–‡ä¼˜åŒ–**ï¼šå¯¹äºä¸Šä¸‹æ–‡çª—å£è¾ƒå°çš„æ¨¡å‹ï¼Œå»ºè®®å…³é—­æ‚¨å½“å‰ä»»åŠ¡ä¸éœ€è¦çš„å·¥å…·ï¼Œä»¥æé«˜å“åº”é€Ÿåº¦å’Œå‡†ç¡®æ€§ã€‚

æ¬¢è¿è´¡çŒ®é«˜æ•ˆçš„æç¤ºè¯é…ç½®ï¼Œè®© AI æ›´èªæ˜åœ°å·¥ä½œï¼

---

### AI ä½œè€…ä¸å…è´£å£°æ˜

æœ¬é¡¹ç›®åœ¨ **Gemini AI** çš„å¤§åŠ›ååŠ©ä¸‹å¼€å‘ã€‚å› æ­¤ï¼š
*   **å®éªŒæ€§è´¨**: è¿™æ˜¯ä¸€ä¸ªå®éªŒæ€§é¡¹ç›®ã€‚å…¶å¯é æ€§ä¸ä½œä¿è¯ã€‚
*   **å•†ä¸šç”¨é€”**: åœ¨æœªç»è¿‡å½»åº•çš„ç‹¬ç«‹éªŒè¯å¹¶å……åˆ†ç†è§£å…¶å±€é™æ€§ä¹‹å‰ï¼Œä¸å»ºè®®ç”¨äºå•†ä¸šç”¨é€”ã€‚
*   **å…è´£å£°æ˜**: ä½¿ç”¨é£é™©è‡ªè´Ÿã€‚å¼€å‘è€…å’ŒAIå¯¹å› ä½¿ç”¨æœ¬é¡¹ç›®è€Œäº§ç”Ÿçš„ä»»ä½•åæœæ¦‚ä¸è´Ÿè´£ã€‚

---

### å½“å‰æŠ€æœ¯æ¶æ„æ¦‚è§ˆ

è¯¥ç³»ç»Ÿç°åœ¨ä¸»è¦ä¾èµ– `UE5_UMG_MCP` æ’ä»¶ï¼Œç”¨äºå¤–éƒ¨å®¢æˆ·ç«¯ï¼ˆå¦‚æœ¬CLIï¼‰ä¸Unreal Engineç¼–è¾‘å™¨ä¹‹é—´çš„é€šä¿¡ã€‚

**æ¶æ„å›¾:** 

```mermaid
flowchart LR
    subgraph "æœ¬åœ°æ‰§è¡Œç¯å¢ƒ (Local Environment)"
        CLI[Gemini CLI] --"StdIO (JSON-RPC)"--> PY[Python (UmgMcpServer.py)]
    end

    subgraph "Unreal Engine 5"
        PY --"TCP Socket (JSON)"--> TCP[UmgMcpBridge (C++)]
        TCP --> API[Unreal API / UMG]
    end
```

## API å®ç°çŠ¶æ€

| åˆ†ç±» | API åç§° | çŠ¶æ€ | æè¿° |
|---|---|:---:|---|
| **ä¸Šä¸‹æ–‡ä¸æ³¨æ„åŠ›** | `get_target_umg_asset` | âœ… | è·å–å½“å‰æ“ä½œçš„UMGèµ„äº§ã€‚ |
| | `set_target_umg_asset` | âœ… | è®¾ç½®å…¨å±€æ“ä½œçš„UMGèµ„äº§ç›®æ ‡ã€‚ |
| | `get_last_edited_umg_asset` | âœ… | è·å–æœ€åç¼–è¾‘çš„UMGèµ„äº§ã€‚ |
| | `get_recently_edited_umg_assets` | âœ… | è·å–æœ€è¿‘ç¼–è¾‘è¿‡çš„UMGèµ„äº§åˆ—è¡¨ã€‚ |
| **æ„ŸçŸ¥ä¸æŸ¥è¯¢** | `get_widget_tree` | âœ… | è·å–èµ„äº§çš„å®Œæ•´æ§ä»¶æ ‘ç»“æ„ã€‚ |
| | `query_widget_properties` | âœ… | æŸ¥è¯¢ç‰¹å®šæ§ä»¶çš„ä¸€ä¸ªæˆ–å¤šä¸ªå±æ€§å€¼ã€‚ |
| | `get_creatable_widget_types` | âœ… | è·å–æ‰€æœ‰å¯ä»¥è¢«åˆ›å»ºçš„æ§ä»¶ç±»å‹åˆ—è¡¨ã€‚ |
| | `get_widget_schema` | âœ… | è·å–æŒ‡å®šæ§ä»¶ç±»å‹çš„å±æ€§ç»“æ„ä¿¡æ¯ã€‚ |
| | `get_layout_data` | âœ… | è·å–æ‰€æœ‰æ§ä»¶åœ¨ç»™å®šåˆ†è¾¨ç‡ä¸‹çš„å±å¹•å¸ƒå±€æ•°æ®ã€‚ |
| | `check_widget_overlap` | âœ… | æ£€æŸ¥UIå¸ƒå±€ä¸­æ˜¯å¦æœ‰æ§ä»¶å‘ç”Ÿé‡å ã€‚ |
| **æ“ä½œä¸ä¿®æ”¹** | `create_widget` | âœ… | åˆ›å»ºä¸€ä¸ªæ–°çš„æ§ä»¶å¹¶é™„åŠ åˆ°çˆ¶æ§ä»¶ã€‚ |
| | `delete_widget` | âœ… | æ ¹æ®åç§°åˆ é™¤ä¸€ä¸ªæ§ä»¶ã€‚ |
| | `set_widget_properties` | âœ… | è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ªæ§ä»¶å±æ€§ã€‚ |
| | `reparent_widget` | âœ… | å°†ä¸€ä¸ªæ§ä»¶ç§»åŠ¨åˆ°æ–°çš„çˆ¶æ§ä»¶ä¸‹ã€‚ |
| | `save_asset` | âœ… | ä¿å­˜å½“å‰çš„UMGèµ„äº§ã€‚ |
| **æ–‡ä»¶è½¬æ¢** | `export_umg_to_json` | âœ… | å°†UMGèµ„äº§å¯¼å‡ºä¸ºJSONå­—ç¬¦ä¸²ã€‚ |
| | `apply_json_to_umg` | âœ… | å°†JSONæ•°æ®åº”ç”¨åˆ°UMGèµ„äº§ã€‚ |
| | `apply_layout` | âœ… | å°†HTML/XMLå¸ƒå±€åº”ç”¨åˆ°UMGèµ„äº§ã€‚ |

## UMG Sequencer API å®ç°çŠ¶æ€

| åˆ†ç±» | API åç§° | çŠ¶æ€ | æè¿° |
|---|---|:---:|---|
| **åŠ¨ç”»ç®¡ç†** | `get_all_animations` | âœ… | è·å–æ‰€æœ‰åŠ¨ç”»åˆ—è¡¨ã€‚ |
| | `create_animation` | âœ… | åˆ›å»ºæ–°çš„åŠ¨ç”»åºåˆ—ã€‚ |
| | `delete_animation` | âœ… | åˆ é™¤æŒ‡å®šçš„åŠ¨ç”»åºåˆ—ã€‚ |
| | `set_animation_scope` | âœ… | è®¾ç½®åç»­å‘½ä»¤çš„ç›®æ ‡åŠ¨ç”»ã€‚ |
| | `set_widget_scope` | âœ… | è®¾ç½®åç»­å‘½ä»¤çš„ç›®æ ‡æ§ä»¶ã€‚ |
| **è½¨é“ä¸å…³é”®å¸§** | `set_property_keys` | âœ… | è®¾ç½®å±æ€§çš„å…³é”®å¸§ï¼ˆç›®å‰ä»…æ”¯æŒæµ®ç‚¹ï¼‰ã€‚ |
| | `remove_property_track` | â³ | ç§»é™¤å±æ€§è½¨é“ã€‚ |
| | `remove_keys` | â³ | ç§»é™¤ç‰¹å®šå…³é”®å¸§ã€‚ |
| | `get_animation_keyframes` | â³ | è·å–åŠ¨ç”»çš„å…³é”®å¸§æ•°æ®ã€‚ |
| | `get_animated_widgets` | â³ | è·å–å—åŠ¨ç”»å½±å“çš„æ§ä»¶åˆ—è¡¨ã€‚ |
